{"version":3,"sources":["index.js","helpers.js","workbook.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = exports.build = exports.parseMetadata = exports.parse = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _xlsx = _interopRequireDefault(require(\"xlsx\"));\n\nvar _bufferFrom = _interopRequireDefault(require(\"buffer-from\"));\n\nvar _helpers = require(\"./helpers\");\n\nvar _workbook = _interopRequireDefault(require(\"./workbook\"));\n\nvar parse = function parse(mixed, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var workSheet = _xlsx.default[(0, _helpers.isString)(mixed) ? 'readFile' : 'read'](mixed, options);\n\n  return Object.keys(workSheet.Sheets).map(function (name) {\n    var sheet = workSheet.Sheets[name];\n    return {\n      name,\n      data: _xlsx.default.utils.sheet_to_json(sheet, {\n        header: 1,\n        raw: options.raw !== false,\n        range: options.range ? options.range[name] : null\n      })\n    };\n  });\n};\n\nexports.parse = parse;\n\nvar parseMetadata = function parseMetadata(mixed, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var workSheet = _xlsx.default[(0, _helpers.isString)(mixed) ? 'readFile' : 'read'](mixed, options);\n\n  return Object.keys(workSheet.Sheets).map(function (name) {\n    var sheet = workSheet.Sheets[name];\n    return {\n      name,\n      data: sheet[\"!ref\"] ? _xlsx.default.utils.decode_range(sheet[\"!ref\"]) : null\n    };\n  });\n};\n\nexports.parseMetadata = parseMetadata;\n\nvar build = function build(worksheets, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var defaults = {\n    bookType: 'xlsx',\n    bookSST: false,\n    type: 'binary'\n  };\n  var workBook = new _workbook.default();\n  worksheets.forEach(function (worksheet) {\n    var sheetName = worksheet.name || 'Sheet';\n    var sheetOptions = worksheet.options || {};\n    var sheetData = (0, _helpers.buildSheetFromMatrix)(worksheet.data || [], (0, _extends2.default)({}, options, sheetOptions));\n    workBook.SheetNames.push(sheetName);\n    workBook.Sheets[sheetName] = sheetData;\n  });\n\n  var excelData = _xlsx.default.write(workBook, (0, _extends2.default)({}, defaults, options));\n\n  return excelData instanceof Buffer ? excelData : (0, _bufferFrom.default)(excelData, 'binary');\n};\n\nexports.build = build;\nvar _default = {\n  parse,\n  parseMetadata,\n  build\n};\nexports.default = _default;\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.buildSheetFromMatrix = exports.buildExcelDate = exports.isCellDescriptor = exports.isObject = exports.isString = exports.isNumber = exports.isBoolean = void 0;\n\nvar _xlsx = _interopRequireDefault(require(\"xlsx\"));\n\nvar ORIGIN_DATE = new Date(Date.UTC(1899, 11, 30));\n\nvar isBoolean = function isBoolean(maybeBoolean) {\n  return typeof maybeBoolean === 'boolean';\n};\n\nexports.isBoolean = isBoolean;\n\nvar isNumber = function isNumber(maybeNumber) {\n  return typeof maybeNumber === 'number';\n};\n\nexports.isNumber = isNumber;\n\nvar isString = function isString(maybeString) {\n  return typeof maybeString === 'string';\n};\n\nexports.isString = isString;\n\nvar isObject = function isObject(maybeObject) {\n  return maybeObject !== null && typeof maybeObject === 'object';\n};\n\nexports.isObject = isObject;\n\nvar isCellDescriptor = function isCellDescriptor(maybeCell) {\n  return isObject(maybeCell) && 'v' in maybeCell;\n};\n\nexports.isCellDescriptor = isCellDescriptor;\nvar SUPPORTED_WS_OPTIONS = ['!cols', '!rows', '!merges', '!autofilter', '!protect'];\n\nvar buildExcelDate = function buildExcelDate(value, is1904) {\n  var epoch = Date.parse(value + (is1904 ? 1462 : 0));\n  return (epoch - ORIGIN_DATE) / 864e5;\n};\n\nexports.buildExcelDate = buildExcelDate;\n\nvar buildSheetFromMatrix = function buildSheetFromMatrix(data, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var workSheet = {};\n  var range = {\n    s: {\n      c: 1e7,\n      r: 1e7\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  if (!Array.isArray(data)) throw new Error('sheet data is not array');\n\n  for (var R = 0; R !== data.length; R += 1) {\n    for (var C = 0; C !== data[R].length; C += 1) {\n      if (!Array.isArray(data[R])) throw new Error(`${R}th row data is not array`);\n      if (range.s.r > R) range.s.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (range.e.c < C) range.e.c = C;\n\n      if (data[R][C] === null) {\n        continue; // eslint-disable-line\n      }\n\n      var cell = isCellDescriptor(data[R][C]) ? data[R][C] : {\n        v: data[R][C]\n      };\n\n      var cellRef = _xlsx.default.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (isNumber(cell.v)) {\n        cell.t = 'n';\n      } else if (isBoolean(cell.v)) {\n        cell.t = 'b';\n      } else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.v = buildExcelDate(cell.v);\n        cell.z = cell.z || _xlsx.default.SSF._table[14]; // eslint-disable-line no-underscore-dangle\n\n        /* eslint-disable spaced-comment, no-trailing-spaces */\n\n        /***\n         * Allows for an non-abstracted representation of the data\n         *\n         * example: {t:'n', z:10, f:'=AVERAGE(A:A)'}\n         *\n         * Documentation:\n         * - Cell Object: https://sheetjs.gitbooks.io/docs/#cell-object\n         * - Data Types: https://sheetjs.gitbooks.io/docs/#data-types\n         * - Format: https://sheetjs.gitbooks.io/docs/#number-formats\n         **/\n\n        /* eslint-disable spaced-comment, no-trailing-spaces */\n      } else if (isObject(cell.v)) {\n        cell.t = cell.v.t;\n        cell.f = cell.v.f;\n        cell.F = cell.v.F;\n        cell.z = cell.v.z;\n      } else {\n        cell.t = 's';\n      }\n\n      if (isNumber(cell.z)) cell.z = _xlsx.default.SSF._table[cell.z]; // eslint-disable-line no-underscore-dangle\n\n      workSheet[cellRef] = cell;\n    }\n  }\n\n  if (range.s.c < 1e7) {\n    workSheet['!ref'] = _xlsx.default.utils.encode_range(range);\n  }\n\n  SUPPORTED_WS_OPTIONS.forEach(function (option) {\n    if (options[option]) {\n      workSheet[option] = options[option];\n    }\n  });\n  return workSheet;\n};\n\nexports.buildSheetFromMatrix = buildSheetFromMatrix;\n//# sourceMappingURL=helpers.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar Workbook = function Workbook() {\n  (0, _defineProperty2.default)(this, \"SheetNames\", []);\n  (0, _defineProperty2.default)(this, \"Sheets\", {});\n};\n\nexports.default = Workbook;\n//# sourceMappingURL=workbook.js.map"]}